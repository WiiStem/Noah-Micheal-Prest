<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>D&D Spell Cards</title>
    <style>
      h1 {
        background-color: red;
        color: black;
        text-align: center;
        padding: 10px;
      }

      body {
        font-family: Arial, sans-serif;
        background-color: black;
      }

      summary {
        color: red;
        font-size: 20px;
        cursor: pointer;
        margin-top: 10px;
      }

      li {
        cursor: pointer;
        margin: 4px 0;
        width: fit-content;
        color: red;
      }

      li:hover {
        color: red;
      }

      .button {
        background-color: red;
        border-radius: 5px;
        font-weight: bold;
        font-size: 18px;
        font-family: monospace;
        color: white;
        padding: 20px;
        margin-left: 10px;
        text-align: center;
        cursor: pointer;
      }
    </style>
  </head>

  <body>
    <h1>D&D 5e Spells</h1>
    <a href="index.html"><button class="button">Home</button></a>

    <div id="spellList"></div>

    <script>
      const container = document.getElementById("spellList");
      const groupedSpells = {};

      fetch("https://www.dnd5eapi.co/api/2014/spells")
        .then((res) => res.json())
        .then((data) => {
          data.results.forEach((spell) => {
            fetch(`https://www.dnd5eapi.co/api/2014/spells/${spell.index}`)
              .then((res) => res.json())
              .then((details) => {
                const level = details.level;

                if (!groupedSpells[level]) {
                  groupedSpells[level] = [];
                }

                groupedSpells[level].push(details);
                renderSpells();
              });
          });
        });

      function renderSpells() {
        container.innerHTML = "";

        Object.keys(groupedSpells)
          .sort((a, b) => a - b)
          .forEach((level) => {
            const details = document.createElement("details");
            const summary = document.createElement("summary");
            const ul = document.createElement("ul");

            summary.textContent =
              level === "0" ? "Default Spells" : `Level ${level} Spells`;

            groupedSpells[level]
              .sort((a, b) => a.name.localeCompare(b.name))
              .forEach((spell) => {
                const li = document.createElement("li");
                li.textContent = spell.name;
                li.onclick = () => loadSpell(spell.index);
                ul.appendChild(li);
              });

            details.appendChild(summary);
            details.appendChild(ul);
            container.appendChild(details);
          });
      }

      function loadSpell(index) {
        fetch(`https://www.dnd5eapi.co/api/2014/spells/${index}`)
          .then((res) => res.json())
          .then((spell) => {
            alert(
              `${spell.name}\n` +
                `Level: ${spell.level}\n` +
                `School: ${spell.school.name}\n` +
                `Casting Time: ${spell.casting_time}`
            );
          });
      }
    </script>
  </body>
</html>
